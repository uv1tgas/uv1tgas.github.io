{"version":3,"file":"index.js","sources":["../src/snapshot.ts","../src/BareTypes.ts","../src/Client.ts","../src/md5.ts","../src/splitHeaderUtil.ts","../src/V3.ts","../src/webSocket.ts","../src/BareClient.ts","../src/index.ts"],"sourcesContent":["// The user likely has overwritten all networking functions after importing bare-client\n// It is our responsibility to make sure components of Bare-Client are using native networking functions\n\n// These exports are provided to plugins by @rollup/plugin-inject\n\nexport const fetch = globalThis.fetch;\nexport const WebSocket = globalThis.WebSocket;\nexport const Request = globalThis.Request;\nexport const Response = globalThis.Response;\nexport const XMLHttpRequest = globalThis.XMLHttpRequest;\n\nexport const WebSocketFields = {\n\tprototype: {\n\t\tsend: WebSocket.prototype.send,\n\t},\n\tCLOSED: WebSocket.CLOSED,\n\tCLOSING: WebSocket.CLOSING,\n\tCONNECTING: WebSocket.CONNECTING,\n\tOPEN: WebSocket.OPEN,\n};\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nexport type BareMethod =\n\t| 'GET'\n\t| 'POST'\n\t| 'DELETE'\n\t| 'OPTIONS'\n\t| 'PUT'\n\t| 'PATCH'\n\t| 'UPDATE'\n\t| string;\n\nexport type BareCache =\n\t| 'default'\n\t| 'no-store'\n\t| 'reload'\n\t| 'no-cache'\n\t| 'force-cache'\n\t| 'only-if-cached'\n\t| string;\n\nexport interface BareWebSocketMeta {\n\tprotocol: string;\n\tsetCookies: string[];\n}\n\nexport type BareHTTPProtocol = 'blob:' | 'http:' | 'https:' | string;\nexport type BareWSProtocol = 'ws:' | 'wss:' | string;\n\nexport type urlLike = URL | string;\n\nexport const maxRedirects = 20;\n\nexport type BareHeaders = Record<string, string | string[]>;\n\n/**\n * A Response with additional properties.\n */\nexport interface BareResponse extends Response {\n\trawResponse: Response;\n\trawHeaders: BareHeaders;\n}\n\n/**\n * A BareResponse with additional properties.\n */\nexport interface BareResponseFetch extends BareResponse {\n\tfinalURL: string;\n}\n\nexport type BareBodyInit =\n\t| Blob\n\t| BufferSource\n\t| FormData\n\t| URLSearchParams\n\t| ReadableStream\n\t| undefined\n\t| null;\n\nexport type BareFetchInit = {\n\tmethod?: BareMethod;\n\theaders?: Headers | BareHeaders;\n\tbody?: BareBodyInit;\n\tcache?: BareCache;\n\tredirect?: 'follow' | 'manual' | 'error' | string;\n\tsignal?: AbortSignal;\n};\n\nexport interface BareMaintainer {\n\temail?: string;\n\twebsite?: string;\n}\n\nexport interface BareProject {\n\tname?: string;\n\tdescription?: string;\n\temail?: string;\n\twebsite?: string;\n\trepository?: string;\n\tversion?: string;\n}\n\nexport type BareLanguage =\n\t| 'NodeJS'\n\t| 'ServiceWorker'\n\t| 'Deno'\n\t| 'Java'\n\t| 'PHP'\n\t| 'Rust'\n\t| 'C'\n\t| 'C++'\n\t| 'C#'\n\t| 'Ruby'\n\t| 'Go'\n\t| 'Crystal'\n\t| 'Shell'\n\t| string;\n\nexport interface BareManifest {\n\tmaintainer?: BareMaintainer;\n\tproject?: BareProject;\n\tversions: string[];\n\tlanguage: BareLanguage;\n\tmemoryUsage?: number;\n}\n","import type {\n\tBareBodyInit,\n\tBareCache,\n\tBareHeaders,\n\tBareMethod,\n\tBareResponse,\n\tBareWebSocketMeta,\n} from './BareTypes.js';\n\nexport const statusEmpty = [101, 204, 205, 304];\nexport const statusRedirect = [301, 302, 303, 307, 308];\n\nexport interface BareErrorBody {\n\tcode: string;\n\tid: string;\n\tmessage?: string;\n\tstack?: string;\n}\n\nexport class BareError extends Error {\n\tstatus: number;\n\tbody: BareErrorBody;\n\tconstructor(status: number, body: BareErrorBody) {\n\t\tsuper(body.message || body.code);\n\t\tthis.status = status;\n\t\tthis.body = body;\n\t}\n}\n\nexport type MetaCallback = (meta: BareWebSocketMeta) => void;\nexport type ReadyStateCallback = (readyState: number) => void;\nexport type WebSocketImpl = {\n\tnew(...args: ConstructorParameters<typeof WebSocket>): WebSocket;\n};\nexport type GetRequestHeadersCallback = () => Promise<BareHeaders>;\n\nexport abstract class Client {\n\tabstract connect(\n\t\tremote: URL,\n\t\tprotocols: string[],\n\t\tgetRequestHeaders: GetRequestHeadersCallback,\n\t\tonMeta: MetaCallback,\n\t\tonReadyState: ReadyStateCallback,\n\t\twebSocketImpl: WebSocketImpl\n\t): WebSocket;\n\tabstract request(\n\t\tmethod: BareMethod,\n\t\trequestHeaders: BareHeaders,\n\t\tbody: BareBodyInit,\n\t\tremote: URL,\n\t\tcache: BareCache | undefined,\n\t\tduplex: string | undefined,\n\t\tsignal: AbortSignal | undefined\n\t): Promise<BareResponse>;\n\tprotected base: URL;\n\t/**\n\t *\n\t * @param version Version provided by extension\n\t * @param server Bare Server URL provided by BareClient\n\t */\n\tconstructor(version: number, server: URL) {\n\t\tthis.base = new URL(`./v${version}/`, server);\n\t}\n}\n","/*\n * JavaScript MD5\n * Adopted from https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\n\n/**\n * Add integers, wrapping at 2^32.\n * This uses 16-bit operations internally to work around bugs in interpreters.\n *\n * @param x First integer\n * @param y Second integer\n * @returns Sum\n */\nfunction safeAdd(x: number, y: number): number {\n\tconst lsw = (x & 0xffff) + (y & 0xffff);\n\tconst msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n\treturn (msw << 16) | (lsw & 0xffff);\n}\n\n/**\n * Bitwise rotate a 32-bit number to the left.\n *\n * @param num 32-bit number\n * @param cnt Rotation count\n * @returns  Rotated number\n */\nfunction bitRotateLeft(num: number, cnt: number): number {\n\treturn (num << cnt) | (num >>> (32 - cnt));\n}\n\n/**\n * Basic operation the algorithm uses.\n *\n * @param q q\n * @param a a\n * @param b b\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5cmn(\n\tq: number,\n\ta: number,\n\tb: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5ff(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn((b & c) | (~b & d), a, b, x, s, t);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5gg(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn((b & d) | (c & ~d), a, b, x, s, t);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5hh(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n/**\n * Basic operation the algorithm uses.\n *\n * @param a a\n * @param b b\n * @param c c\n * @param d d\n * @param x x\n * @param s s\n * @param t t\n * @returns Result\n */\nfunction md5ii(\n\ta: number,\n\tb: number,\n\tc: number,\n\td: number,\n\tx: number,\n\ts: number,\n\tt: number\n): number {\n\treturn md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\n/**\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n *\n * @param x Array of little-endian words\n * @param len Bit length\n * @returns MD5 Array\n */\nfunction binlMD5(x: number[], len: number): number[] {\n\t/* append padding */\n\tx[len >> 5] |= 0x80 << len % 32;\n\tx[(((len + 64) >>> 9) << 4) + 14] = len;\n\n\tlet a = 1732584193;\n\tlet b = -271733879;\n\tlet c = -1732584194;\n\tlet d = 271733878;\n\n\tfor (let i = 0; i < x.length; i += 16) {\n\t\tconst olda = a;\n\t\tconst oldb = b;\n\t\tconst oldc = c;\n\t\tconst oldd = d;\n\n\t\ta = md5ff(a, b, c, d, x[i], 7, -680876936);\n\t\td = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n\t\tc = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n\t\tb = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n\t\ta = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n\t\td = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n\t\tc = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n\t\tb = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n\t\ta = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n\t\td = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n\t\tc = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n\t\tb = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n\t\ta = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n\t\td = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n\t\tc = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n\t\tb = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n\n\t\ta = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n\t\td = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n\t\tc = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n\t\tb = md5gg(b, c, d, a, x[i], 20, -373897302);\n\t\ta = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n\t\td = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n\t\tc = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n\t\tb = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n\t\ta = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n\t\td = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n\t\tc = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n\t\tb = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n\t\ta = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n\t\td = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n\t\tc = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n\t\tb = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n\n\t\ta = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n\t\td = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n\t\tc = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n\t\tb = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n\t\ta = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n\t\td = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n\t\tc = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n\t\tb = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n\t\ta = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n\t\td = md5hh(d, a, b, c, x[i], 11, -358537222);\n\t\tc = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n\t\tb = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n\t\ta = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n\t\td = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n\t\tc = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n\t\tb = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n\n\t\ta = md5ii(a, b, c, d, x[i], 6, -198630844);\n\t\td = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n\t\tc = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n\t\tb = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n\t\ta = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n\t\td = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n\t\tc = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n\t\tb = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n\t\ta = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n\t\td = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n\t\tc = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n\t\tb = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n\t\ta = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n\t\td = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n\t\tc = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n\t\tb = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n\n\t\ta = safeAdd(a, olda);\n\t\tb = safeAdd(b, oldb);\n\t\tc = safeAdd(c, oldc);\n\t\td = safeAdd(d, oldd);\n\t}\n\treturn [a, b, c, d];\n}\n\n/**\n * Convert an array of little-endian words to a string\n *\n * @param input MD5 Array\n * @returns MD5 string\n */\nfunction binl2rstr(input: number[]): string {\n\tlet output = '';\n\tconst length32 = input.length * 32;\n\tfor (let i = 0; i < length32; i += 8) {\n\t\toutput += String.fromCharCode((input[i >> 5] >>> i % 32) & 0xff);\n\t}\n\treturn output;\n}\n\n/**\n * Convert a raw string to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n *\n * @param input Raw input string\n * @returns Array of little-endian words\n */\nfunction rstr2binl(input: string): number[] {\n\tconst output: number[] = [];\n\tconst outputLen = input.length >> 2;\n\tfor (let i = 0; i < outputLen; i += 1) {\n\t\toutput[i] = 0;\n\t}\n\tconst length8 = input.length * 8;\n\tfor (let i = 0; i < length8; i += 8) {\n\t\toutput[i >> 5]! |= (input.charCodeAt(i / 8) & 0xff) << i % 32;\n\t}\n\treturn <number[]>output;\n}\n\n/**\n * Calculate the MD5 of a raw string\n *\n * @param s Input string\n * @returns Raw MD5 string\n */\nfunction rstrMD5(s: string): string {\n\treturn binl2rstr(binlMD5(rstr2binl(s), s.length * 8));\n}\n\n/**\n * Calculates the HMAC-MD5 of a key and some data (raw strings)\n *\n * @param key HMAC key\n * @param data Raw input string\n * @returns Raw MD5 string\n */\nfunction rstrHMACMD5(key: string, data: string): string {\n\tlet bkey = rstr2binl(key);\n\tconst ipad: number[] = [];\n\tconst opad: number[] = [];\n\tif (bkey.length > 16) {\n\t\tbkey = binlMD5(bkey, key.length * 8);\n\t}\n\tfor (let i = 0; i < 16; i += 1) {\n\t\tipad[i] = bkey[i] ^ 0x36363636;\n\t\topad[i] = bkey[i] ^ 0x5c5c5c5c;\n\t}\n\tconst hash = binlMD5(ipad.concat(rstr2binl(data)), 512 + data.length * 8);\n\treturn binl2rstr(binlMD5(opad.concat(hash), 512 + 128));\n}\n\n/**\n * Convert a raw string to a hex string\n *\n * @param input Raw input string\n * @returns Hex encoded string\n */\nfunction rstr2hex(input: string): string {\n\tconst hexTab = '0123456789abcdef';\n\tlet output = '';\n\tfor (let i = 0; i < input.length; i += 1) {\n\t\tconst x = input.charCodeAt(i);\n\t\toutput += hexTab.charAt((x >>> 4) & 0x0f) + hexTab.charAt(x & 0x0f);\n\t}\n\treturn output;\n}\n\n/**\n * Encode a string as UTF-8\n *\n * @param input Input string\n * @returns UTF8 string\n */\nfunction str2rstrUTF8(input: string): string {\n\treturn unescape(encodeURIComponent(input));\n}\n\n/**\n * Encodes input string as raw MD5 string\n *\n * @param s Input string\n * @returns Raw MD5 string\n */\nfunction rawMD5(s: string): string {\n\treturn rstrMD5(str2rstrUTF8(s));\n}\n/**\n * Encodes input string as Hex encoded string\n *\n * @param s Input string\n * @returns Hex encoded string\n */\nfunction hexMD5(s: string): string {\n\treturn rstr2hex(rawMD5(s));\n}\n/**\n * Calculates the raw HMAC-MD5 for the given key and data\n *\n * @param k HMAC key\n * @param d Input string\n * @returns Raw MD5 string\n */\nfunction rawHMACMD5(k: string, d: string): string {\n\treturn rstrHMACMD5(str2rstrUTF8(k), str2rstrUTF8(d));\n}\n/**\n * Calculates the Hex encoded HMAC-MD5 for the given key and data\n *\n * @param k HMAC key\n * @param d Input string\n * @returns Raw MD5 string\n */\nfunction hexHMACMD5(k: string, d: string): string {\n\treturn rstr2hex(rawHMACMD5(k, d));\n}\n\n/**\n * Calculates MD5 value for a given string.\n * If a key is provided, calculates the HMAC-MD5 value.\n * Returns a Hex encoded string unless the raw argument is given.\n *\n * @param string Input string\n * @param key HMAC key\n * @param raw Raw output switch\n * @returns MD5 output\n */\nexport default function md5(\n\tstring: string,\n\tkey?: string,\n\traw?: boolean\n): string {\n\tif (!key) {\n\t\tif (!raw) {\n\t\t\treturn hexMD5(string);\n\t\t}\n\t\treturn rawMD5(string);\n\t}\n\tif (!raw) {\n\t\treturn hexHMACMD5(key, string);\n\t}\n\treturn rawHMACMD5(key, string);\n}\n","import { BareError } from './Client';\n\nconst MAX_HEADER_VALUE = 3072;\n\n/**\n *\n * Splits headers according to spec\n * @param headers\n * @returns Split headers\n */\nexport function splitHeaders(headers: Headers): Headers {\n\tconst output = new Headers(headers);\n\n\tif (headers.has('x-bare-headers')) {\n\t\tconst value = headers.get('x-bare-headers')!;\n\n\t\tif (value.length > MAX_HEADER_VALUE) {\n\t\t\toutput.delete('x-bare-headers');\n\n\t\t\tlet split = 0;\n\n\t\t\tfor (let i = 0; i < value.length; i += MAX_HEADER_VALUE) {\n\t\t\t\tconst part = value.slice(i, i + MAX_HEADER_VALUE);\n\n\t\t\t\tconst id = split++;\n\t\t\t\toutput.set(`x-bare-headers-${id}`, `;${part}`);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn output;\n}\n\n/**\n * Joins headers according to spec\n * @param headers\n * @returns Joined headers\n */\nexport function joinHeaders(headers: Headers): Headers {\n\tconst output = new Headers(headers);\n\n\tconst prefix = 'x-bare-headers';\n\n\tif (headers.has(`${prefix}-0`)) {\n\t\tconst join: string[] = [];\n\n\t\tfor (const [header, value] of headers) {\n\t\t\tif (!header.startsWith(prefix)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!value.startsWith(';')) {\n\t\t\t\tthrow new BareError(400, {\n\t\t\t\t\tcode: 'INVALID_BARE_HEADER',\n\t\t\t\t\tid: `request.headers.${header}`,\n\t\t\t\t\tmessage: `Value didn't begin with semi-colon.`,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst id = parseInt(header.slice(prefix.length + 1));\n\n\t\t\tjoin[id] = value.slice(1);\n\n\t\t\toutput.delete(header);\n\t\t}\n\n\t\toutput.set(prefix, join.join(''));\n\t}\n\n\treturn output;\n}\n","import type {\n\tBareBodyInit,\n\tBareCache,\n\tBareHeaders,\n\tBareMethod,\n\tBareResponse,\n} from './BareTypes.js';\nimport { BareError, Client, statusEmpty } from './Client.js';\nimport type {\n\tReadyStateCallback,\n\tMetaCallback,\n\tGetRequestHeadersCallback,\n} from './Client.js';\nimport type {\n\tBareResponseHeaders,\n\tSocketClientToServer,\n\tSocketServerToClient,\n} from './V3Types.js';\nimport md5 from './md5.js';\nimport { WebSocketFields } from './snapshot.js';\nimport { joinHeaders, splitHeaders } from './splitHeaderUtil.js';\n\nexport default class ClientV3 extends Client {\n\tws: URL;\n\thttp: URL;\n\tconstructor(server: URL) {\n\t\tsuper(3, server);\n\n\t\tthis.ws = new URL(this.base);\n\t\tthis.http = new URL(this.base);\n\n\t\tif (this.ws.protocol === 'https:') {\n\t\t\tthis.ws.protocol = 'wss:';\n\t\t} else {\n\t\t\tthis.ws.protocol = 'ws:';\n\t\t}\n\t}\n\tconnect(\n\t\tremote: URL,\n\t\tprotocols: string[],\n\t\tgetRequestHeaders: GetRequestHeadersCallback,\n\t\tonMeta: MetaCallback,\n\t\tonReadyState: ReadyStateCallback\n\t) {\n\t\tconst ws = new WebSocket(this.ws);\n\n\t\tconst cleanup = () => {\n\t\t\tws.removeEventListener('close', closeListener);\n\t\t\tws.removeEventListener('message', messageListener);\n\t\t};\n\n\t\tconst closeListener = () => {\n\t\t\tcleanup();\n\t\t};\n\n\t\tconst messageListener = (event: MessageEvent) => {\n\t\t\tcleanup();\n\n\t\t\t// ws.binaryType is irrelevant when sending text\n\t\t\tif (typeof event.data !== 'string')\n\t\t\t\tthrow new TypeError('the first websocket message was not a text frame');\n\n\t\t\tconst message = JSON.parse(event.data) as SocketServerToClient;\n\n\t\t\t// finally\n\t\t\tif (message.type !== 'open')\n\t\t\t\tthrow new TypeError('message was not of open type');\n\n\t\t\tevent.stopImmediatePropagation();\n\n\t\t\tonMeta({\n\t\t\t\tprotocol: message.protocol,\n\t\t\t\tsetCookies: message.setCookies,\n\t\t\t});\n\n\t\t\t// now we want the client to see the websocket is open and ready to communicate with the remote\n\t\t\tonReadyState(WebSocketFields.OPEN);\n\n\t\t\tws.dispatchEvent(new Event('open'));\n\t\t};\n\n\t\tws.addEventListener('close', closeListener);\n\t\tws.addEventListener('message', messageListener);\n\n\t\t// CONNECTED TO THE BARE SERVER, NOT THE REMOTE\n\t\tws.addEventListener(\n\t\t\t'open',\n\t\t\t(event) => {\n\t\t\t\t// we have to cancel this event because it doesn't reflect the connection to the remote\n\t\t\t\t// once we are actually connected to the remote, we can dispatch a fake open event.\n\t\t\t\tevent.stopImmediatePropagation();\n\n\t\t\t\t// we need to fake the readyState value again so it remains CONNECTING\n\t\t\t\t// right now, it's open because we just connected to the remote\n\t\t\t\t// but we need to fake this from the client so it thinks it's still connecting\n\t\t\t\tonReadyState(WebSocketFields.CONNECTING);\n\n\t\t\t\tgetRequestHeaders().then((headers) =>\n\t\t\t\t\tWebSocketFields.prototype.send.call(\n\t\t\t\t\t\tws,\n\t\t\t\t\t\tJSON.stringify({\n\t\t\t\t\t\t\ttype: 'connect',\n\t\t\t\t\t\t\tremote: remote.toString(),\n\t\t\t\t\t\t\tprotocols,\n\t\t\t\t\t\t\theaders,\n\t\t\t\t\t\t\tforwardHeaders: [],\n\t\t\t\t\t\t} as SocketClientToServer)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t},\n\t\t\t// only block the open event once\n\t\t\t{ once: true }\n\t\t);\n\n\t\treturn ws;\n\t}\n\tasync request(\n\t\tmethod: BareMethod,\n\t\trequestHeaders: BareHeaders,\n\t\tbody: BareBodyInit,\n\t\tremote: URL,\n\t\tcache: BareCache | undefined,\n\t\tduplex: string | undefined,\n\t\tsignal: AbortSignal | undefined,\n\t): Promise<BareResponse> {\n\t\tif (remote.protocol.startsWith('blob:')) {\n\t\t\tconst response = await fetch(remote);\n\t\t\tconst result: Response & Partial<BareResponse> = new Response(\n\t\t\t\tresponse.body,\n\t\t\t\tresponse\n\t\t\t);\n\n\t\t\tresult.rawHeaders = Object.fromEntries(response.headers);\n\t\t\tresult.rawResponse = response;\n\n\t\t\treturn result as BareResponse;\n\t\t}\n\n\t\tconst bareHeaders: BareHeaders = {};\n\n\t\tif (requestHeaders instanceof Headers) {\n\t\t\tfor (const [header, value] of requestHeaders) {\n\t\t\t\tbareHeaders[header] = value;\n\t\t\t}\n\t\t} else {\n\t\t\tfor (const header in requestHeaders) {\n\t\t\t\tbareHeaders[header] = requestHeaders[header];\n\t\t\t}\n\t\t}\n\n\t\tconst options: RequestInit = {\n\t\t\tcredentials: 'omit',\n\t\t\tmethod: method,\n\t\t\tsignal,\n\t\t};\n\n\t\tif (cache !== 'only-if-cached') {\n\t\t\toptions.cache = cache as RequestCache;\n\t\t}\n\n\t\tif (body !== undefined) {\n\t\t\toptions.body = body;\n\t\t}\n\n\t\tif (duplex !== undefined) {\n\t\t\t// @ts-ignore\n\t\t\toptions.duplex = duplex;\n\t\t}\n\n\t\toptions.headers = this.createBareHeaders(remote, bareHeaders);\n\n\t\tconst request = new Request(\n\t\t\tthis.http + '?cache=' + md5(remote.toString()),\n\t\t\toptions\n\t\t);\n\n\t\tconst response = await fetch(request);\n\n\t\tconst readResponse = await this.readBareResponse(response);\n\n\t\tconst result: Response & Partial<BareResponse> = new Response(\n\t\t\tstatusEmpty.includes(readResponse.status!) ? undefined : response.body,\n\t\t\t{\n\t\t\t\tstatus: readResponse.status,\n\t\t\t\tstatusText: readResponse.statusText ?? undefined,\n\t\t\t\theaders: new Headers(readResponse.headers as HeadersInit),\n\t\t\t}\n\t\t);\n\n\t\tresult.rawHeaders = readResponse.headers;\n\t\tresult.rawResponse = response;\n\n\t\treturn result as BareResponse;\n\t}\n\tprivate async readBareResponse(response: Response) {\n\t\tif (!response.ok) {\n\t\t\tthrow new BareError(response.status, await response.json());\n\t\t}\n\n\t\tconst responseHeaders = joinHeaders(response.headers);\n\n\t\tconst result: Partial<BareResponseHeaders> = {};\n\n\t\tconst xBareStatus = responseHeaders.get('x-bare-status');\n\t\tif (xBareStatus !== null) result.status = parseInt(xBareStatus);\n\n\t\tconst xBareStatusText = responseHeaders.get('x-bare-status-text');\n\t\tif (xBareStatusText !== null) result.statusText = xBareStatusText;\n\n\t\tconst xBareHeaders = responseHeaders.get('x-bare-headers');\n\t\tif (xBareHeaders !== null) result.headers = JSON.parse(xBareHeaders);\n\n\t\treturn result as BareResponseHeaders;\n\t}\n\tcreateBareHeaders(\n\t\tremote: URL,\n\t\tbareHeaders: BareHeaders,\n\t\tforwardHeaders: string[] = [],\n\t\tpassHeaders: string[] = [],\n\t\tpassStatus: number[] = []\n\t) {\n\t\tconst headers = new Headers();\n\n\t\theaders.set('x-bare-url', remote.toString());\n\t\theaders.set('x-bare-headers', JSON.stringify(bareHeaders));\n\n\t\tfor (const header of forwardHeaders) {\n\t\t\theaders.append('x-bare-forward-headers', header);\n\t\t}\n\n\t\tfor (const header of passHeaders) {\n\t\t\theaders.append('x-bare-pass-headers', header);\n\t\t}\n\n\t\tfor (const status of passStatus) {\n\t\t\theaders.append('x-bare-pass-status', status.toString());\n\t\t}\n\n\t\tsplitHeaders(headers);\n\n\t\treturn headers;\n\t}\n}\n","/*\n * WebSocket helpers\n */\n\nconst validChars =\n\t\"!#$%&'*+-.0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ^_`abcdefghijklmnopqrstuvwxyz|~\";\n\nexport function validProtocol(protocol: string): boolean {\n\tfor (let i = 0; i < protocol.length; i++) {\n\t\tconst char = protocol[i];\n\n\t\tif (!validChars.includes(char)) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n","import type {\n\tBareHeaders,\n\tBareManifest,\n\tBareResponse,\n\tBareResponseFetch,\n\turlLike,\n} from './BareTypes';\nimport { maxRedirects } from './BareTypes';\nimport type { Client, WebSocketImpl } from './Client';\nimport { statusRedirect } from './Client';\nimport ClientV3 from './V3';\nimport { WebSocketFields } from './snapshot';\nimport { validProtocol } from './webSocket';\n\nconst clientCtors: [string, { new(server: URL): Client }][] = [\n\t['v3', ClientV3],\n];\n\nexport async function fetchManifest(\n\tserver: string | URL,\n\tsignal?: AbortSignal\n): Promise<BareManifest> {\n\tconst outgoing = await fetch(server, { signal });\n\n\tif (!outgoing.ok) {\n\t\tthrow new Error(\n\t\t\t`Unable to fetch Bare meta: ${outgoing.status} ${await outgoing.text()}`\n\t\t);\n\t}\n\n\treturn await outgoing.json();\n}\n\n// get the unhooked value\nconst getRealReadyState = Object.getOwnPropertyDescriptor(\n\tWebSocket.prototype,\n\t'readyState'\n)!.get!;\n\nconst wsProtocols = ['ws:', 'wss:'];\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace BareWebSocket {\n\texport type GetReadyStateCallback = () => number;\n\texport type GetSendErrorCallback = () => Error | undefined;\n\texport type GetProtocolCallback = () => string;\n\texport type HeadersType = BareHeaders | Headers | undefined;\n\texport type HeadersProvider =\n\t\t| BareHeaders\n\t\t| (() => BareHeaders | Promise<BareHeaders>);\n\n\texport interface Options {\n\t\t/**\n\t\t * A provider of request headers to pass to the remote.\n\t\t * Usually one of `User-Agent`, `Origin`, and `Cookie`\n\t\t * Can be just the headers object or an synchronous/asynchronous function that returns the headers object\n\t\t */\n\t\theaders?: BareWebSocket.HeadersProvider;\n\t\t/**\n\t\t * A hook executed by this function with helper arguments for hooking the readyState property. If a hook isn't provided, bare-client will hook the property on the instance. Hooking it on an instance basis is good for small projects, but ideally the class should be hooked by the user of bare-client.\n\t\t */\n\t\treadyStateHook?:\n\t\t| ((\n\t\t\tsocket: WebSocket,\n\t\t\tgetReadyState: BareWebSocket.GetReadyStateCallback\n\t\t) => void)\n\t\t| undefined;\n\t\t/**\n\t\t * A hook executed by this function with helper arguments for determining if the send function should throw an error. If a hook isn't provided, bare-client will hook the function on the instance.\n\t\t */\n\t\tsendErrorHook?:\n\t\t| ((\n\t\t\tsocket: WebSocket,\n\t\t\tgetSendError: BareWebSocket.GetSendErrorCallback\n\t\t) => void)\n\t\t| undefined;\n\t\t/**\n\t\t * A hook executed by this function with the URL. If a hook isn't provided, bare-client will hook the URL.\n\t\t */\n\t\turlHook?: ((socket: WebSocket, url: URL) => void) | undefined;\n\t\t/**\n\t\t * A hook executed by this function with a helper for getting the current fake protocol. If a hook isn't provided, bare-client will hook the protocol.\n\t\t */\n\t\tprotocolHook?:\n\t\t| ((\n\t\t\tsocket: WebSocket,\n\t\t\tgetProtocol: BareWebSocket.GetProtocolCallback\n\t\t) => void)\n\t\t| undefined;\n\t\t/**\n\t\t * A callback executed by this function with an array of cookies. This is called once the metadata from the server is received.\n\t\t */\n\t\tsetCookiesCallback?: ((setCookies: string[]) => void) | undefined;\n\t\twebSocketImpl?: WebSocketImpl;\n\t}\n}\n\nexport class BareClient {\n\tmanifest?: BareManifest;\n\tprivate client?: Client;\n\tprivate server: URL;\n\tprivate working?: Promise<Client>;\n\tprivate onDemand: boolean;\n\tprivate onDemandSignal?: AbortSignal;\n\t/**\n\t * Lazily create a BareClient. Calls to fetch and connect will request the manifest once on-demand.\n\t * @param server A full URL to the bare server.\n\t * @param signal An abort signal for fetching the manifest on demand.\n\t */\n\tconstructor(server: string | URL, signal?: AbortSignal);\n\t/**\n\t * Immediately create a BareClient.\n\t * @param server A full URL to the bare server.\n\t * @param manifest A Bare server manifest.\n\t */\n\tconstructor(server: string | URL, manifest?: BareManifest);\n\tconstructor(server: string | URL, _?: BareManifest | AbortSignal) {\n\t\tthis.server = new URL(server);\n\n\t\tif (!_ || _ instanceof AbortSignal) {\n\t\t\tthis.onDemand = true;\n\t\t\tthis.onDemandSignal = _;\n\t\t} else {\n\t\t\tthis.onDemand = false;\n\t\t\tthis.loadManifest(_);\n\t\t}\n\t}\n\tprivate loadManifest(manifest: BareManifest) {\n\t\tthis.manifest = manifest;\n\t\tthis.client = this.getClient();\n\t\treturn this.client;\n\t}\n\tprivate demand() {\n\t\tif (!this.onDemand) return this.client!;\n\n\t\tif (!this.working)\n\t\t\tthis.working = fetchManifest(this.server, this.onDemandSignal)\n\t\t\t\t.then((manifest) => this.loadManifest(manifest))\n\t\t\t\t.catch((err) => {\n\t\t\t\t\t// allow the next request to re-fetch the manifest\n\t\t\t\t\t// this is to prevent BareClient from permanently failing when used on demand\n\t\t\t\t\tdelete this.working;\n\t\t\t\t\tthrow err;\n\t\t\t\t});\n\n\t\treturn this.working;\n\t}\n\tprivate getClient() {\n\t\t// newest-oldest\n\t\tfor (const [version, ctor] of clientCtors)\n\t\t\tif (this.manifest!.versions.includes(version))\n\t\t\t\treturn new ctor(this.server);\n\n\t\tthrow new Error(\n\t\t\t'Unable to find compatible client version. Starting from v2.0.0, @tomphttp/bare-client only supports Bare servers v3+. For more information, see https://github.com/tomphttp/bare-client/'\n\t\t);\n\t}\n\tcreateWebSocket(\n\t\tremote: urlLike,\n\t\tprotocols: string | string[] | undefined = [],\n\t\toptions: BareWebSocket.Options\n\t): WebSocket {\n\t\tif (!this.client)\n\t\t\tthrow new TypeError(\n\t\t\t\t'You need to wait for the client to finish fetching the manifest before creating any WebSockets. Try caching the manifest data before making this request.'\n\t\t\t);\n\n\t\ttry {\n\t\t\tremote = new URL(remote);\n\t\t} catch (err) {\n\t\t\tthrow new DOMException(\n\t\t\t\t`Faiiled to construct 'WebSocket': The URL '${remote}' is invalid.`\n\t\t\t);\n\t\t}\n\n\t\tif (!wsProtocols.includes(remote.protocol))\n\t\t\tthrow new DOMException(\n\t\t\t\t`Failed to construct 'WebSocket': The URL's scheme must be either 'ws' or 'wss'. '${remote.protocol}' is not allowed.`\n\t\t\t);\n\n\t\tif (!Array.isArray(protocols)) protocols = [protocols];\n\n\t\tprotocols = protocols.map(String);\n\n\t\tfor (const proto of protocols)\n\t\t\tif (!validProtocol(proto))\n\t\t\t\tthrow new DOMException(\n\t\t\t\t\t`Failed to construct 'WebSocket': The subprotocol '${proto}' is invalid.`\n\t\t\t\t);\n\n\t\tconst socket = this.client.connect(\n\t\t\tremote,\n\t\t\tprotocols,\n\t\t\tasync () => {\n\t\t\t\tconst resolvedHeaders =\n\t\t\t\t\ttypeof options.headers === 'function'\n\t\t\t\t\t\t? await options.headers()\n\t\t\t\t\t\t: options.headers || {};\n\n\t\t\t\tconst requestHeaders: BareHeaders =\n\t\t\t\t\tresolvedHeaders instanceof Headers\n\t\t\t\t\t\t? Object.fromEntries(resolvedHeaders)\n\t\t\t\t\t\t: resolvedHeaders;\n\n\t\t\t\t// user is expected to specify user-agent and origin\n\t\t\t\t// both are in spec\n\n\t\t\t\trequestHeaders['Host'] = (remote as URL).host;\n\t\t\t\t// requestHeaders['Origin'] = origin;\n\t\t\t\trequestHeaders['Pragma'] = 'no-cache';\n\t\t\t\trequestHeaders['Cache-Control'] = 'no-cache';\n\t\t\t\trequestHeaders['Upgrade'] = 'websocket';\n\t\t\t\t// requestHeaders['User-Agent'] = navigator.userAgent;\n\t\t\t\trequestHeaders['Connection'] = 'Upgrade';\n\n\t\t\t\treturn requestHeaders;\n\t\t\t},\n\t\t\t(meta) => {\n\t\t\t\tfakeProtocol = meta.protocol;\n\t\t\t\tif (options.setCookiesCallback)\n\t\t\t\t\toptions.setCookiesCallback(meta.setCookies);\n\t\t\t},\n\t\t\t(readyState) => {\n\t\t\t\tfakeReadyState = readyState;\n\t\t\t},\n\t\t\toptions.webSocketImpl || WebSocket\n\t\t);\n\n\t\t// protocol is always an empty before connecting\n\t\t// updated when we receive the metadata\n\t\t// this value doesn't change when it's CLOSING or CLOSED etc\n\t\tlet fakeProtocol = '';\n\n\t\tlet fakeReadyState: number = WebSocketFields.CONNECTING;\n\n\t\tconst getReadyState = () => {\n\t\t\tconst realReadyState = getRealReadyState.call(socket);\n\t\t\t// readyState should only be faked when the real readyState is OPEN\n\t\t\treturn realReadyState === WebSocketFields.OPEN\n\t\t\t\t? fakeReadyState\n\t\t\t\t: realReadyState;\n\t\t};\n\n\t\tif (options.readyStateHook) options.readyStateHook(socket, getReadyState);\n\t\telse {\n\t\t\t// we have to hook .readyState ourselves\n\n\t\t\tObject.defineProperty(socket, 'readyState', {\n\t\t\t\tget: getReadyState,\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * @returns The error that should be thrown if send() were to be called on this socket according to the fake readyState value\n\t\t */\n\t\tconst getSendError = () => {\n\t\t\tconst readyState = getReadyState();\n\n\t\t\tif (readyState === WebSocketFields.CONNECTING)\n\t\t\t\treturn new DOMException(\n\t\t\t\t\t\"Failed to execute 'send' on 'WebSocket': Still in CONNECTING state.\"\n\t\t\t\t);\n\t\t};\n\n\t\tif (options.sendErrorHook) options.sendErrorHook(socket, getSendError);\n\t\telse {\n\t\t\t// we have to hook .send ourselves\n\t\t\t// use ...args to avoid giving the number of args a quantity\n\t\t\t// no arguments will trip the following error: TypeError: Failed to execute 'send' on 'WebSocket': 1 argument required, but only 0 present.\n\t\t\tsocket.send = function (...args) {\n\t\t\t\tconst error = getSendError();\n\n\t\t\t\tif (error) throw error;\n\t\t\t\telse WebSocketFields.prototype.send.call(this, ...args);\n\t\t\t};\n\t\t}\n\n\t\tif (options.urlHook) options.urlHook(socket, remote);\n\t\telse\n\t\t\tObject.defineProperty(socket, 'url', {\n\t\t\t\tget: () => remote.toString(),\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t});\n\n\t\tconst getProtocol = () => fakeProtocol;\n\n\t\tif (options.protocolHook) options.protocolHook(socket, getProtocol);\n\t\telse\n\t\t\tObject.defineProperty(socket, 'protocol', {\n\t\t\t\tget: getProtocol,\n\t\t\t\tconfigurable: true,\n\t\t\t\tenumerable: true,\n\t\t\t});\n\n\t\treturn socket;\n\t}\n\n\tasync fetch(\n\t\turl: urlLike | Request,\n\t\tinit?: RequestInit\n\t): Promise<BareResponseFetch> {\n\t\tconst req = isUrlLike(url) ? new Request(url, init) : url;\n\n\t\t// try to use init.headers because it may contain capitalized headers\n\t\t// furthermore, important headers on the Request class are blocked...\n\t\t// we should try to preserve the capitalization due to quirks with earlier servers\n\t\tconst inputHeaders = init?.headers || req.headers;\n\n\t\tconst headers: BareHeaders =\n\t\t\tinputHeaders instanceof Headers\n\t\t\t\t? Object.fromEntries(inputHeaders)\n\t\t\t\t: (inputHeaders as BareHeaders);\n\n\t\tlet urlO = new URL(req.url);\n\n\t\tconst client = await this.demand();\n\n\t\tfor (let i = 0; ; i++) {\n\t\t\tif ('host' in headers) headers.host = urlO.host;\n\t\t\telse headers.Host = urlO.host;\n\n\t\t\tconst response: BareResponse & Partial<BareResponseFetch> =\n\t\t\t\tawait client.request(\n\t\t\t\t\treq.method,\n\t\t\t\t\theaders,\n\t\t\t\t\treq.body,\n\t\t\t\t\turlO,\n\t\t\t\t\treq.cache,\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\treq.duplex,\n\t\t\t\t\treq.signal\n\t\t\t\t);\n\n\t\t\tresponse.finalURL = urlO.toString();\n\n\t\t\tconst redirect = init?.redirect || req.redirect;\n\n\t\t\tif (statusRedirect.includes(response.status)) {\n\t\t\t\tswitch (redirect) {\n\t\t\t\t\tcase 'follow': {\n\t\t\t\t\t\tconst location = response.headers.get('location');\n\t\t\t\t\t\tif (maxRedirects > i && location !== null) {\n\t\t\t\t\t\t\turlO = new URL(location, urlO);\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t} else throw new TypeError('Failed to fetch');\n\t\t\t\t\t}\n\t\t\t\t\tcase 'error':\n\t\t\t\t\t\tthrow new TypeError('Failed to fetch');\n\t\t\t\t\tcase 'manual':\n\t\t\t\t\t\treturn response as BareResponseFetch;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn response as BareResponseFetch;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction isUrlLike(url: unknown): url is urlLike {\n\treturn typeof url === 'string' || url instanceof URL;\n}\n","import { BareClient, fetchManifest } from './BareClient';\n\nexport * from './Client';\nexport * from './BareTypes';\nexport * from './BareClient';\n\n/**\n *\n * Facilitates fetching the Bare server and constructing a BareClient.\n * @param server Bare server\n * @param signal Abort signal when fetching the manifest\n */\nexport async function createBareClient(\n\tserver: string | URL,\n\tsignal?: AbortSignal\n): Promise<BareClient> {\n\tconst manifest = await fetchManifest(server, signal);\n\n\treturn new BareClient(server, manifest);\n}\n"],"names":[],"mappings":"AAAA;AACA;AAEA;AAEO,MAAM,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC;AAC/B,MAAM,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC;AACvC,MAAM,OAAO,GAAG,UAAU,CAAC,OAAO,CAAC;AACnC,MAAM,QAAQ,GAAG,UAAU,CAAC,QAAQ,CAAC;AAGrC,MAAM,eAAe,GAAG;AAC9B,IAAA,SAAS,EAAE;AACV,QAAA,IAAI,EAAE,SAAS,CAAC,SAAS,CAAC,IAAI;AAC9B,KAAA;IACD,MAAM,EAAE,SAAS,CAAC,MAAM;IACxB,OAAO,EAAE,SAAS,CAAC,OAAO;IAC1B,UAAU,EAAE,SAAS,CAAC,UAAU;IAChC,IAAI,EAAE,SAAS,CAAC,IAAI;CACpB;;ACWM,MAAM,YAAY,GAAG;;ACrBrB,MAAM,WAAW,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE;AACzC,MAAM,cAAc,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE;AASlD,MAAO,SAAU,SAAQ,KAAK,CAAA;AACnC,IAAA,MAAM,CAAS;AACf,IAAA,IAAI,CAAgB;IACpB,WAAY,CAAA,MAAc,EAAE,IAAmB,EAAA;QAC9C,KAAK,CAAC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC;AACjC,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;AACrB,QAAA,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;KACjB;AACD,CAAA;MASqB,MAAM,CAAA;AAkBjB,IAAA,IAAI,CAAM;AACpB;;;;AAIG;IACH,WAAY,CAAA,OAAe,EAAE,MAAW,EAAA;AACvC,QAAA,IAAI,CAAC,IAAI,GAAG,IAAI,GAAG,CAAC,CAAM,GAAA,EAAA,OAAO,CAAG,CAAA,CAAA,EAAE,MAAM,CAAC,CAAC;KAC9C;AACD;;AC/DD;;;;;;;;;;;;;;;;;AAiBG;AAEH;;;;;;;AAOG;AACH,SAAS,OAAO,CAAC,CAAS,EAAE,CAAS,EAAA;AACpC,IAAA,MAAM,GAAG,GAAG,CAAC,CAAC,GAAG,MAAM,KAAK,CAAC,GAAG,MAAM,CAAC,CAAC;AACxC,IAAA,MAAM,GAAG,GAAG,CAAC,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,EAAE,CAAC,IAAI,GAAG,IAAI,EAAE,CAAC,CAAC;IAChD,OAAO,CAAC,GAAG,IAAI,EAAE,KAAK,GAAG,GAAG,MAAM,CAAC,CAAC;AACrC,CAAC;AAED;;;;;;AAMG;AACH,SAAS,aAAa,CAAC,GAAW,EAAE,GAAW,EAAA;AAC9C,IAAA,OAAO,CAAC,GAAG,IAAI,GAAG,KAAK,GAAG,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC;AAC5C,CAAC;AAED;;;;;;;;;;AAUG;AACH,SAAS,MAAM,CACd,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EAAA;IAET,OAAO,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAC5E,CAAC;AACD;;;;;;;;;;;AAWG;AACH,SAAS,KAAK,CACb,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EAAA;IAET,OAAO,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AAClD,CAAC;AACD;;;;;;;;;;;AAWG;AACH,SAAS,KAAK,CACb,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EAAA;IAET,OAAO,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AAClD,CAAC;AACD;;;;;;;;;;;AAWG;AACH,SAAS,KAAK,CACb,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EAAA;AAET,IAAA,OAAO,MAAM,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AACzC,CAAC;AACD;;;;;;;;;;;AAWG;AACH,SAAS,KAAK,CACb,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EACT,CAAS,EAAA;IAET,OAAO,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AAC5C,CAAC;AAED;;;;;;AAMG;AACH,SAAS,OAAO,CAAC,CAAW,EAAE,GAAW,EAAA;;IAExC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,IAAI,IAAI,IAAI,GAAG,GAAG,EAAE,CAAC;AAChC,IAAA,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,EAAE,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC,GAAG,GAAG,CAAC;IAExC,IAAI,CAAC,GAAG,UAAU,CAAC;AACnB,IAAA,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC;AACnB,IAAA,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC;IACpB,IAAI,CAAC,GAAG,SAAS,CAAC;AAElB,IAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,IAAI,EAAE,EAAE;QACtC,MAAM,IAAI,GAAG,CAAC,CAAC;QACf,MAAM,IAAI,GAAG,CAAC,CAAC;QACf,MAAM,IAAI,GAAG,CAAC,CAAC;QACf,MAAM,IAAI,GAAG,CAAC,CAAC;QAEf,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QAC3C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,UAAU,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC;QAC7C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QAClD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,UAAU,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QAClD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC;QAEjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;QAC5C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC;QAC9C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,CAAC;QAC9C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;QAC9C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QAElD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;QAC5C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QAClD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,SAAS,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;QAC5C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,QAAQ,CAAC,CAAC;QAC9C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;QAEhD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QAC3C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QAClD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,UAAU,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,UAAU,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;QAChD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC;QACjD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC;QAClD,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;QAC/C,CAAC,GAAG,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,CAAC;AAEhD,QAAA,CAAC,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;AACrB,QAAA,CAAC,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;AACrB,QAAA,CAAC,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;AACrB,QAAA,CAAC,GAAG,OAAO,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;AACrB,KAAA;IACD,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AACrB,CAAC;AAED;;;;;AAKG;AACH,SAAS,SAAS,CAAC,KAAe,EAAA;IACjC,IAAI,MAAM,GAAG,EAAE,CAAC;AAChB,IAAA,MAAM,QAAQ,GAAG,KAAK,CAAC,MAAM,GAAG,EAAE,CAAC;AACnC,IAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,EAAE,CAAC,IAAI,CAAC,EAAE;QACrC,MAAM,IAAI,MAAM,CAAC,YAAY,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,GAAG,EAAE,IAAI,IAAI,CAAC,CAAC;AACjE,KAAA;AACD,IAAA,OAAO,MAAM,CAAC;AACf,CAAC;AAED;;;;;;AAMG;AACH,SAAS,SAAS,CAAC,KAAa,EAAA;IAC/B,MAAM,MAAM,GAAa,EAAE,CAAC;AAC5B,IAAA,MAAM,SAAS,GAAG,KAAK,CAAC,MAAM,IAAI,CAAC,CAAC;AACpC,IAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,EAAE,CAAC,IAAI,CAAC,EAAE;AACtC,QAAA,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;AACd,KAAA;AACD,IAAA,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;AACjC,IAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,IAAI,CAAC,EAAE;QACpC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAE,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,KAAK,CAAC,GAAG,EAAE,CAAC;AAC9D,KAAA;AACD,IAAA,OAAiB,MAAM,CAAC;AACzB,CAAC;AAED;;;;;AAKG;AACH,SAAS,OAAO,CAAC,CAAS,EAAA;AACzB,IAAA,OAAO,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;AACvD,CAAC;AAED;;;;;;AAMG;AACH,SAAS,WAAW,CAAC,GAAW,EAAE,IAAY,EAAA;AAC7C,IAAA,IAAI,IAAI,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC;IAC1B,MAAM,IAAI,GAAa,EAAE,CAAC;IAC1B,MAAM,IAAI,GAAa,EAAE,CAAC;AAC1B,IAAA,IAAI,IAAI,CAAC,MAAM,GAAG,EAAE,EAAE;QACrB,IAAI,GAAG,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;AACrC,KAAA;AACD,IAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE;QAC/B,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC;QAC/B,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC;AAC/B,KAAA;IACD,MAAM,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;AAC1E,IAAA,OAAO,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC;AACzD,CAAC;AAED;;;;;AAKG;AACH,SAAS,QAAQ,CAAC,KAAa,EAAA;IAC9B,MAAM,MAAM,GAAG,kBAAkB,CAAC;IAClC,IAAI,MAAM,GAAG,EAAE,CAAC;AAChB,IAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE;QACzC,MAAM,CAAC,GAAG,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;QAC9B,MAAM,IAAI,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC;AACpE,KAAA;AACD,IAAA,OAAO,MAAM,CAAC;AACf,CAAC;AAED;;;;;AAKG;AACH,SAAS,YAAY,CAAC,KAAa,EAAA;AAClC,IAAA,OAAO,QAAQ,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAC;AAC5C,CAAC;AAED;;;;;AAKG;AACH,SAAS,MAAM,CAAC,CAAS,EAAA;AACxB,IAAA,OAAO,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;AACjC,CAAC;AACD;;;;;AAKG;AACH,SAAS,MAAM,CAAC,CAAS,EAAA;AACxB,IAAA,OAAO,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;AAC5B,CAAC;AACD;;;;;;AAMG;AACH,SAAS,UAAU,CAAC,CAAS,EAAE,CAAS,EAAA;AACvC,IAAA,OAAO,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;AACtD,CAAC;AACD;;;;;;AAMG;AACH,SAAS,UAAU,CAAC,CAAS,EAAE,CAAS,EAAA;IACvC,OAAO,QAAQ,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACnC,CAAC;AAED;;;;;;;;;AASG;AACqB,SAAA,GAAG,CAC1B,MAAc,EACd,GAAY,EACZ,GAAa,EAAA;IAEb,IAAI,CAAC,GAAG,EAAE;QACT,IAAI,CAAC,GAAG,EAAE;AACT,YAAA,OAAO,MAAM,CAAC,MAAM,CAAC,CAAC;AACtB,SAAA;AACD,QAAA,OAAO,MAAM,CAAC,MAAM,CAAC,CAAC;AACtB,KAAA;IACD,IAAI,CAAC,GAAG,EAAE;AACT,QAAA,OAAO,UAAU,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;AAC/B,KAAA;AACD,IAAA,OAAO,UAAU,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;AAChC;;AC5ZA,MAAM,gBAAgB,GAAG,IAAI,CAAC;AAE9B;;;;;AAKG;AACG,SAAU,YAAY,CAAC,OAAgB,EAAA;AAC5C,IAAA,MAAM,MAAM,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,CAAC;AAEpC,IAAA,IAAI,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAC,EAAE;QAClC,MAAM,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,gBAAgB,CAAE,CAAC;AAE7C,QAAA,IAAI,KAAK,CAAC,MAAM,GAAG,gBAAgB,EAAE;AACpC,YAAA,MAAM,CAAC,MAAM,CAAC,gBAAgB,CAAC,CAAC;YAEhC,IAAI,KAAK,GAAG,CAAC,CAAC;AAEd,YAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,IAAI,gBAAgB,EAAE;AACxD,gBAAA,MAAM,IAAI,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,GAAG,gBAAgB,CAAC,CAAC;AAElD,gBAAA,MAAM,EAAE,GAAG,KAAK,EAAE,CAAC;gBACnB,MAAM,CAAC,GAAG,CAAC,CAAkB,eAAA,EAAA,EAAE,CAAE,CAAA,EAAE,CAAI,CAAA,EAAA,IAAI,CAAE,CAAA,CAAC,CAAC;AAC/C,aAAA;AACD,SAAA;AACD,KAAA;AAED,IAAA,OAAO,MAAM,CAAC;AACf,CAAC;AAED;;;;AAIG;AACG,SAAU,WAAW,CAAC,OAAgB,EAAA;AAC3C,IAAA,MAAM,MAAM,GAAG,IAAI,OAAO,CAAC,OAAO,CAAC,CAAC;IAEpC,MAAM,MAAM,GAAG,gBAAgB,CAAC;IAEhC,IAAI,OAAO,CAAC,GAAG,CAAC,GAAG,MAAM,CAAA,EAAA,CAAI,CAAC,EAAE;QAC/B,MAAM,IAAI,GAAa,EAAE,CAAC;QAE1B,KAAK,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,OAAO,EAAE;AACtC,YAAA,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;gBAC/B,SAAS;AACT,aAAA;AAED,YAAA,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;AAC3B,gBAAA,MAAM,IAAI,SAAS,CAAC,GAAG,EAAE;AACxB,oBAAA,IAAI,EAAE,qBAAqB;oBAC3B,EAAE,EAAE,CAAmB,gBAAA,EAAA,MAAM,CAAE,CAAA;AAC/B,oBAAA,OAAO,EAAE,CAAqC,mCAAA,CAAA;AAC9C,iBAAA,CAAC,CAAC;AACH,aAAA;AAED,YAAA,MAAM,EAAE,GAAG,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YAErD,IAAI,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;AAE1B,YAAA,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;AACtB,SAAA;AAED,QAAA,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;AAClC,KAAA;AAED,IAAA,OAAO,MAAM,CAAC;AACf;;AChDqB,MAAA,QAAS,SAAQ,MAAM,CAAA;AAC3C,IAAA,EAAE,CAAM;AACR,IAAA,IAAI,CAAM;AACV,IAAA,WAAA,CAAY,MAAW,EAAA;AACtB,QAAA,KAAK,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;QAEjB,IAAI,CAAC,EAAE,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC7B,IAAI,CAAC,IAAI,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AAE/B,QAAA,IAAI,IAAI,CAAC,EAAE,CAAC,QAAQ,KAAK,QAAQ,EAAE;AAClC,YAAA,IAAI,CAAC,EAAE,CAAC,QAAQ,GAAG,MAAM,CAAC;AAC1B,SAAA;AAAM,aAAA;AACN,YAAA,IAAI,CAAC,EAAE,CAAC,QAAQ,GAAG,KAAK,CAAC;AACzB,SAAA;KACD;IACD,OAAO,CACN,MAAW,EACX,SAAmB,EACnB,iBAA4C,EAC5C,MAAoB,EACpB,YAAgC,EAAA;QAEhC,MAAM,EAAE,GAAG,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAElC,MAAM,OAAO,GAAG,MAAK;AACpB,YAAA,EAAE,CAAC,mBAAmB,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;AAC/C,YAAA,EAAE,CAAC,mBAAmB,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;AACpD,SAAC,CAAC;QAEF,MAAM,aAAa,GAAG,MAAK;AAC1B,YAAA,OAAO,EAAE,CAAC;AACX,SAAC,CAAC;AAEF,QAAA,MAAM,eAAe,GAAG,CAAC,KAAmB,KAAI;AAC/C,YAAA,OAAO,EAAE,CAAC;;AAGV,YAAA,IAAI,OAAO,KAAK,CAAC,IAAI,KAAK,QAAQ;AACjC,gBAAA,MAAM,IAAI,SAAS,CAAC,kDAAkD,CAAC,CAAC;YAEzE,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAyB,CAAC;;AAG/D,YAAA,IAAI,OAAO,CAAC,IAAI,KAAK,MAAM;AAC1B,gBAAA,MAAM,IAAI,SAAS,CAAC,8BAA8B,CAAC,CAAC;YAErD,KAAK,CAAC,wBAAwB,EAAE,CAAC;AAEjC,YAAA,MAAM,CAAC;gBACN,QAAQ,EAAE,OAAO,CAAC,QAAQ;gBAC1B,UAAU,EAAE,OAAO,CAAC,UAAU;AAC9B,aAAA,CAAC,CAAC;;AAGH,YAAA,YAAY,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;YAEnC,EAAE,CAAC,aAAa,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;AACrC,SAAC,CAAC;AAEF,QAAA,EAAE,CAAC,gBAAgB,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC;AAC5C,QAAA,EAAE,CAAC,gBAAgB,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;;QAGhD,EAAE,CAAC,gBAAgB,CAClB,MAAM,EACN,CAAC,KAAK,KAAI;;;YAGT,KAAK,CAAC,wBAAwB,EAAE,CAAC;;;;AAKjC,YAAA,YAAY,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;YAEzC,iBAAiB,EAAE,CAAC,IAAI,CAAC,CAAC,OAAO,KAChC,eAAe,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAClC,EAAE,EACF,IAAI,CAAC,SAAS,CAAC;AACd,gBAAA,IAAI,EAAE,SAAS;AACf,gBAAA,MAAM,EAAE,MAAM,CAAC,QAAQ,EAAE;gBACzB,SAAS;gBACT,OAAO;AACP,gBAAA,cAAc,EAAE,EAAE;aACM,CAAC,CAC1B,CACD,CAAC;SACF;;AAED,QAAA,EAAE,IAAI,EAAE,IAAI,EAAE,CACd,CAAC;AAEF,QAAA,OAAO,EAAE,CAAC;KACV;AACD,IAAA,MAAM,OAAO,CACZ,MAAkB,EAClB,cAA2B,EAC3B,IAAkB,EAClB,MAAW,EACX,KAA4B,EAC5B,MAA0B,EAC1B,MAA+B,EAAA;QAE/B,IAAI,MAAM,CAAC,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE;AACxC,YAAA,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,MAAM,CAAC,CAAC;YACrC,MAAM,MAAM,GAAqC,IAAI,QAAQ,CAC5D,QAAQ,CAAC,IAAI,EACb,QAAQ,CACR,CAAC;YAEF,MAAM,CAAC,UAAU,GAAG,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;AACzD,YAAA,MAAM,CAAC,WAAW,GAAG,QAAQ,CAAC;AAE9B,YAAA,OAAO,MAAsB,CAAC;AAC9B,SAAA;QAED,MAAM,WAAW,GAAgB,EAAE,CAAC;QAEpC,IAAI,cAAc,YAAY,OAAO,EAAE;YACtC,KAAK,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC,IAAI,cAAc,EAAE;AAC7C,gBAAA,WAAW,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC;AAC5B,aAAA;AACD,SAAA;AAAM,aAAA;AACN,YAAA,KAAK,MAAM,MAAM,IAAI,cAAc,EAAE;gBACpC,WAAW,CAAC,MAAM,CAAC,GAAG,cAAc,CAAC,MAAM,CAAC,CAAC;AAC7C,aAAA;AACD,SAAA;AAED,QAAA,MAAM,OAAO,GAAgB;AAC5B,YAAA,WAAW,EAAE,MAAM;AACnB,YAAA,MAAM,EAAE,MAAM;YACd,MAAM;SACN,CAAC;QAEF,IAAI,KAAK,KAAK,gBAAgB,EAAE;AAC/B,YAAA,OAAO,CAAC,KAAK,GAAG,KAAqB,CAAC;AACtC,SAAA;QAED,IAAI,IAAI,KAAK,SAAS,EAAE;AACvB,YAAA,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;AACpB,SAAA;QAED,IAAI,MAAM,KAAK,SAAS,EAAE;;AAEzB,YAAA,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC;AACxB,SAAA;QAED,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;QAE9D,MAAM,OAAO,GAAG,IAAI,OAAO,CAC1B,IAAI,CAAC,IAAI,GAAG,SAAS,GAAG,GAAG,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC,EAC9C,OAAO,CACP,CAAC;AAEF,QAAA,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,OAAO,CAAC,CAAC;QAEtC,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;QAE3D,MAAM,MAAM,GAAqC,IAAI,QAAQ,CAC5D,WAAW,CAAC,QAAQ,CAAC,YAAY,CAAC,MAAO,CAAC,GAAG,SAAS,GAAG,QAAQ,CAAC,IAAI,EACtE;YACC,MAAM,EAAE,YAAY,CAAC,MAAM;AAC3B,YAAA,UAAU,EAAE,YAAY,CAAC,UAAU,IAAI,SAAS;AAChD,YAAA,OAAO,EAAE,IAAI,OAAO,CAAC,YAAY,CAAC,OAAsB,CAAC;AACzD,SAAA,CACD,CAAC;AAEF,QAAA,MAAM,CAAC,UAAU,GAAG,YAAY,CAAC,OAAO,CAAC;AACzC,QAAA,MAAM,CAAC,WAAW,GAAG,QAAQ,CAAC;AAE9B,QAAA,OAAO,MAAsB,CAAC;KAC9B;IACO,MAAM,gBAAgB,CAAC,QAAkB,EAAA;AAChD,QAAA,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE;AACjB,YAAA,MAAM,IAAI,SAAS,CAAC,QAAQ,CAAC,MAAM,EAAE,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC;AAC5D,SAAA;QAED,MAAM,eAAe,GAAG,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QAEtD,MAAM,MAAM,GAAiC,EAAE,CAAC;QAEhD,MAAM,WAAW,GAAG,eAAe,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;QACzD,IAAI,WAAW,KAAK,IAAI;AAAE,YAAA,MAAM,CAAC,MAAM,GAAG,QAAQ,CAAC,WAAW,CAAC,CAAC;QAEhE,MAAM,eAAe,GAAG,eAAe,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;QAClE,IAAI,eAAe,KAAK,IAAI;AAAE,YAAA,MAAM,CAAC,UAAU,GAAG,eAAe,CAAC;QAElE,MAAM,YAAY,GAAG,eAAe,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;QAC3D,IAAI,YAAY,KAAK,IAAI;YAAE,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;AAErE,QAAA,OAAO,MAA6B,CAAC;KACrC;AACD,IAAA,iBAAiB,CAChB,MAAW,EACX,WAAwB,EACxB,cAAA,GAA2B,EAAE,EAC7B,WAAwB,GAAA,EAAE,EAC1B,UAAA,GAAuB,EAAE,EAAA;AAEzB,QAAA,MAAM,OAAO,GAAG,IAAI,OAAO,EAAE,CAAC;QAE9B,OAAO,CAAC,GAAG,CAAC,YAAY,EAAE,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;AAC7C,QAAA,OAAO,CAAC,GAAG,CAAC,gBAAgB,EAAE,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;AAE3D,QAAA,KAAK,MAAM,MAAM,IAAI,cAAc,EAAE;AACpC,YAAA,OAAO,CAAC,MAAM,CAAC,wBAAwB,EAAE,MAAM,CAAC,CAAC;AACjD,SAAA;AAED,QAAA,KAAK,MAAM,MAAM,IAAI,WAAW,EAAE;AACjC,YAAA,OAAO,CAAC,MAAM,CAAC,qBAAqB,EAAE,MAAM,CAAC,CAAC;AAC9C,SAAA;AAED,QAAA,KAAK,MAAM,MAAM,IAAI,UAAU,EAAE;YAChC,OAAO,CAAC,MAAM,CAAC,oBAAoB,EAAE,MAAM,CAAC,QAAQ,EAAE,CAAC,CAAC;AACxD,SAAA;QAED,YAAY,CAAC,OAAO,CAAC,CAAC;AAEtB,QAAA,OAAO,OAAO,CAAC;KACf;AACD;;AClPD;;AAEG;AAEH,MAAM,UAAU,GACf,+EAA+E,CAAC;AAE3E,SAAU,aAAa,CAAC,QAAgB,EAAA;AAC7C,IAAA,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACzC,QAAA,MAAM,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;AAEzB,QAAA,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;AAC/B,YAAA,OAAO,KAAK,CAAC;AACb,SAAA;AACD,KAAA;AAED,IAAA,OAAO,IAAI,CAAC;AACb;;ACHA,MAAM,WAAW,GAA6C;IAC7D,CAAC,IAAI,EAAE,QAAQ,CAAC;CAChB,CAAC;AAEK,eAAe,aAAa,CAClC,MAAoB,EACpB,MAAoB,EAAA;IAEpB,MAAM,QAAQ,GAAG,MAAM,KAAK,CAAC,MAAM,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC;AAEjD,IAAA,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE;AACjB,QAAA,MAAM,IAAI,KAAK,CACd,CAAA,2BAAA,EAA8B,QAAQ,CAAC,MAAM,CAAI,CAAA,EAAA,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAA,CAAE,CACxE,CAAC;AACF,KAAA;AAED,IAAA,OAAO,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;AAC9B,CAAC;AAED;AACA,MAAM,iBAAiB,GAAG,MAAM,CAAC,wBAAwB,CACxD,SAAS,CAAC,SAAS,EACnB,YAAY,CACX,CAAC,GAAI,CAAC;AAER,MAAM,WAAW,GAAG,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;MA0DvB,UAAU,CAAA;AACtB,IAAA,QAAQ,CAAgB;AAChB,IAAA,MAAM,CAAU;AAChB,IAAA,MAAM,CAAM;AACZ,IAAA,OAAO,CAAmB;AAC1B,IAAA,QAAQ,CAAU;AAClB,IAAA,cAAc,CAAe;IAarC,WAAY,CAAA,MAAoB,EAAE,CAA8B,EAAA;QAC/D,IAAI,CAAC,MAAM,GAAG,IAAI,GAAG,CAAC,MAAM,CAAC,CAAC;AAE9B,QAAA,IAAI,CAAC,CAAC,IAAI,CAAC,YAAY,WAAW,EAAE;AACnC,YAAA,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;AACrB,YAAA,IAAI,CAAC,cAAc,GAAG,CAAC,CAAC;AACxB,SAAA;AAAM,aAAA;AACN,YAAA,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;AACtB,YAAA,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;AACrB,SAAA;KACD;AACO,IAAA,YAAY,CAAC,QAAsB,EAAA;AAC1C,QAAA,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;AACzB,QAAA,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;QAC/B,OAAO,IAAI,CAAC,MAAM,CAAC;KACnB;IACO,MAAM,GAAA;QACb,IAAI,CAAC,IAAI,CAAC,QAAQ;YAAE,OAAO,IAAI,CAAC,MAAO,CAAC;QAExC,IAAI,CAAC,IAAI,CAAC,OAAO;AAChB,YAAA,IAAI,CAAC,OAAO,GAAG,aAAa,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,cAAc,CAAC;AAC5D,iBAAA,IAAI,CAAC,CAAC,QAAQ,KAAK,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;AAC/C,iBAAA,KAAK,CAAC,CAAC,GAAG,KAAI;;;gBAGd,OAAO,IAAI,CAAC,OAAO,CAAC;AACpB,gBAAA,MAAM,GAAG,CAAC;AACX,aAAC,CAAC,CAAC;QAEL,OAAO,IAAI,CAAC,OAAO,CAAC;KACpB;IACO,SAAS,GAAA;;AAEhB,QAAA,KAAK,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,WAAW;YACxC,IAAI,IAAI,CAAC,QAAS,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC;AAC5C,gBAAA,OAAO,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AAE/B,QAAA,MAAM,IAAI,KAAK,CACd,0LAA0L,CAC1L,CAAC;KACF;AACD,IAAA,eAAe,CACd,MAAe,EACf,SAA2C,GAAA,EAAE,EAC7C,OAA8B,EAAA;QAE9B,IAAI,CAAC,IAAI,CAAC,MAAM;AACf,YAAA,MAAM,IAAI,SAAS,CAClB,2JAA2J,CAC3J,CAAC;QAEH,IAAI;AACH,YAAA,MAAM,GAAG,IAAI,GAAG,CAAC,MAAM,CAAC,CAAC;AACzB,SAAA;AAAC,QAAA,OAAO,GAAG,EAAE;AACb,YAAA,MAAM,IAAI,YAAY,CACrB,8CAA8C,MAAM,CAAA,aAAA,CAAe,CACnE,CAAC;AACF,SAAA;QAED,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC;YACzC,MAAM,IAAI,YAAY,CACrB,CAAA,iFAAA,EAAoF,MAAM,CAAC,QAAQ,CAAmB,iBAAA,CAAA,CACtH,CAAC;AAEH,QAAA,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,CAAC;AAAE,YAAA,SAAS,GAAG,CAAC,SAAS,CAAC,CAAC;AAEvD,QAAA,SAAS,GAAG,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QAElC,KAAK,MAAM,KAAK,IAAI,SAAS;AAC5B,YAAA,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC;AACxB,gBAAA,MAAM,IAAI,YAAY,CACrB,qDAAqD,KAAK,CAAA,aAAA,CAAe,CACzE,CAAC;AAEJ,QAAA,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CACjC,MAAM,EACN,SAAS,EACT,YAAW;AACV,YAAA,MAAM,eAAe,GACpB,OAAO,OAAO,CAAC,OAAO,KAAK,UAAU;AACpC,kBAAE,MAAM,OAAO,CAAC,OAAO,EAAE;AACzB,kBAAE,OAAO,CAAC,OAAO,IAAI,EAAE,CAAC;AAE1B,YAAA,MAAM,cAAc,GACnB,eAAe,YAAY,OAAO;AACjC,kBAAE,MAAM,CAAC,WAAW,CAAC,eAAe,CAAC;kBACnC,eAAe,CAAC;;;AAKpB,YAAA,cAAc,CAAC,MAAM,CAAC,GAAI,MAAc,CAAC,IAAI,CAAC;;AAE9C,YAAA,cAAc,CAAC,QAAQ,CAAC,GAAG,UAAU,CAAC;AACtC,YAAA,cAAc,CAAC,eAAe,CAAC,GAAG,UAAU,CAAC;AAC7C,YAAA,cAAc,CAAC,SAAS,CAAC,GAAG,WAAW,CAAC;;AAExC,YAAA,cAAc,CAAC,YAAY,CAAC,GAAG,SAAS,CAAC;AAEzC,YAAA,OAAO,cAAc,CAAC;AACvB,SAAC,EACD,CAAC,IAAI,KAAI;AACR,YAAA,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC;YAC7B,IAAI,OAAO,CAAC,kBAAkB;AAC7B,gBAAA,OAAO,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;AAC9C,SAAC,EACD,CAAC,UAAU,KAAI;YACd,cAAc,GAAG,UAAU,CAAC;AAC7B,SAAC,EACD,OAAO,CAAC,aAAa,IAAI,SAAS,CAClC,CAAC;;;;QAKF,IAAI,YAAY,GAAG,EAAE,CAAC;AAEtB,QAAA,IAAI,cAAc,GAAW,eAAe,CAAC,UAAU,CAAC;QAExD,MAAM,aAAa,GAAG,MAAK;YAC1B,MAAM,cAAc,GAAG,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;;AAEtD,YAAA,OAAO,cAAc,KAAK,eAAe,CAAC,IAAI;AAC7C,kBAAE,cAAc;kBACd,cAAc,CAAC;AACnB,SAAC,CAAC;QAEF,IAAI,OAAO,CAAC,cAAc;AAAE,YAAA,OAAO,CAAC,cAAc,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;AACrE,aAAA;;AAGJ,YAAA,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,YAAY,EAAE;AAC3C,gBAAA,GAAG,EAAE,aAAa;AAClB,gBAAA,YAAY,EAAE,IAAI;AAClB,gBAAA,UAAU,EAAE,IAAI;AAChB,aAAA,CAAC,CAAC;AACH,SAAA;AAED;;AAEG;QACH,MAAM,YAAY,GAAG,MAAK;AACzB,YAAA,MAAM,UAAU,GAAG,aAAa,EAAE,CAAC;AAEnC,YAAA,IAAI,UAAU,KAAK,eAAe,CAAC,UAAU;AAC5C,gBAAA,OAAO,IAAI,YAAY,CACtB,qEAAqE,CACrE,CAAC;AACJ,SAAC,CAAC;QAEF,IAAI,OAAO,CAAC,aAAa;AAAE,YAAA,OAAO,CAAC,aAAa,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;AAClE,aAAA;;;;AAIJ,YAAA,MAAM,CAAC,IAAI,GAAG,UAAU,GAAG,IAAI,EAAA;AAC9B,gBAAA,MAAM,KAAK,GAAG,YAAY,EAAE,CAAC;AAE7B,gBAAA,IAAI,KAAK;AAAE,oBAAA,MAAM,KAAK,CAAC;;AAClB,oBAAA,eAAe,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,IAAI,CAAC,CAAC;AACzD,aAAC,CAAC;AACF,SAAA;QAED,IAAI,OAAO,CAAC,OAAO;AAAE,YAAA,OAAO,CAAC,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;;AAEpD,YAAA,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,KAAK,EAAE;AACpC,gBAAA,GAAG,EAAE,MAAM,MAAM,CAAC,QAAQ,EAAE;AAC5B,gBAAA,YAAY,EAAE,IAAI;AAClB,gBAAA,UAAU,EAAE,IAAI;AAChB,aAAA,CAAC,CAAC;AAEJ,QAAA,MAAM,WAAW,GAAG,MAAM,YAAY,CAAC;QAEvC,IAAI,OAAO,CAAC,YAAY;AAAE,YAAA,OAAO,CAAC,YAAY,CAAC,MAAM,EAAE,WAAW,CAAC,CAAC;;AAEnE,YAAA,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,UAAU,EAAE;AACzC,gBAAA,GAAG,EAAE,WAAW;AAChB,gBAAA,YAAY,EAAE,IAAI;AAClB,gBAAA,UAAU,EAAE,IAAI;AAChB,aAAA,CAAC,CAAC;AAEJ,QAAA,OAAO,MAAM,CAAC;KACd;AAED,IAAA,MAAM,KAAK,CACV,GAAsB,EACtB,IAAkB,EAAA;QAElB,MAAM,GAAG,GAAG,SAAS,CAAC,GAAG,CAAC,GAAG,IAAI,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,GAAG,GAAG,CAAC;;;;QAK1D,MAAM,YAAY,GAAG,IAAI,EAAE,OAAO,IAAI,GAAG,CAAC,OAAO,CAAC;AAElD,QAAA,MAAM,OAAO,GACZ,YAAY,YAAY,OAAO;AAC9B,cAAE,MAAM,CAAC,WAAW,CAAC,YAAY,CAAC;cAC/B,YAA4B,CAAC;QAElC,IAAI,IAAI,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AAE5B,QAAA,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,MAAM,EAAE,CAAC;AAEnC,QAAA,KAAK,IAAI,CAAC,GAAG,CAAC,GAAI,CAAC,EAAE,EAAE;YACtB,IAAI,MAAM,IAAI,OAAO;AAAE,gBAAA,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;;AAC3C,gBAAA,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;YAE9B,MAAM,QAAQ,GACb,MAAM,MAAM,CAAC,OAAO,CACnB,GAAG,CAAC,MAAM,EACV,OAAO,EACP,GAAG,CAAC,IAAI,EACR,IAAI,EACJ,GAAG,CAAC,KAAK;;AAET,YAAA,GAAG,CAAC,MAAM,EACV,GAAG,CAAC,MAAM,CACV,CAAC;AAEH,YAAA,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YAEpC,MAAM,QAAQ,GAAG,IAAI,EAAE,QAAQ,IAAI,GAAG,CAAC,QAAQ,CAAC;YAEhD,IAAI,cAAc,CAAC,QAAQ,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;AAC7C,gBAAA,QAAQ,QAAQ;oBACf,KAAK,QAAQ,EAAE;wBACd,MAAM,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;AAClD,wBAAA,IAAI,YAAY,GAAG,CAAC,IAAI,QAAQ,KAAK,IAAI,EAAE;4BAC1C,IAAI,GAAG,IAAI,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;4BAC/B,SAAS;AACT,yBAAA;;AAAM,4BAAA,MAAM,IAAI,SAAS,CAAC,iBAAiB,CAAC,CAAC;AAC9C,qBAAA;AACD,oBAAA,KAAK,OAAO;AACX,wBAAA,MAAM,IAAI,SAAS,CAAC,iBAAiB,CAAC,CAAC;AACxC,oBAAA,KAAK,QAAQ;AACZ,wBAAA,OAAO,QAA6B,CAAC;AACtC,iBAAA;AACD,aAAA;AAAM,iBAAA;AACN,gBAAA,OAAO,QAA6B,CAAC;AACrC,aAAA;AACD,SAAA;KACD;AACD,CAAA;AAED,SAAS,SAAS,CAAC,GAAY,EAAA;IAC9B,OAAO,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,YAAY,GAAG,CAAC;AACtD;;ACrWA;;;;;AAKG;AACI,eAAe,gBAAgB,CACrC,MAAoB,EACpB,MAAoB,EAAA;IAEpB,MAAM,QAAQ,GAAG,MAAM,aAAa,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;AAErD,IAAA,OAAO,IAAI,UAAU,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;AACzC;;;;"}